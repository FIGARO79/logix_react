<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Logix - Conciliación</title>
    <link rel="icon" type="image/svg+xml"
        href="{{ secure_url_for(request, 'static', path='images/gear-wide-connected.svg') }}">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="/static/css/fallback.css">
    <!-- SAP '72' Font -->
    <link rel="stylesheet" href="https://ui5.sap.com/resources/sap/ui/core/themes/sap_fiori_3/library.css">
    <style>
        @font-face {
            font-family: '72';
            src: url('https://ui5.sap.com/sdk/resources/sap/ui/core/themes/sap_fiori_3/fonts/72-Regular.woff2') format('woff2');
            font-weight: 400;
            font-style: normal;
        }

        @font-face {
            font-family: '72';
            src: url('https://ui5.sap.com/sdk/resources/sap/ui/core/themes/sap_fiori_3/fonts/72-Bold.woff2') format('woff2');
            font-weight: 700;
            font-style: normal;
        }
    </style>
    <style>
        /* ===== SAP Fiori Quartz/Belize Theme ===== */
        :root {
            --sapBrandColor: #0a6ed1;
            --sapHighlightColor: #0854a0;
            --sapBaseColor: #fff;
            --sapShellColor: #354a5f;
            --sapBackgroundColor: #f7f7f7;
            --sapFontFamily: '72', '72full', Arial, Helvetica, sans-serif;
            --sapFontSize: 0.875rem;
            --sapTextColor: #32363a;
            --sapLinkColor: #0a6ed1;

            --sapPositiveColor: #107e3e;
            --sapNegativeColor: #b00;
            --sapCriticalColor: #e9730c;
            --sapNeutralColor: #6a6d70;
            --sapInformativeColor: #0a6ed1;

            --sapTileBackground: #fff;
            --sapTileBorder: #d9d9d9;
            --sapButtonBackground: #fff;
            --sapButtonBorderColor: #0854a0;
            --sapButtonHoverBackground: #ebf5fe;
            --sapFieldBackground: #fff;
            --sapFieldBorderColor: #89919a;
            --sapList_HeaderBackground: #f7f7f7;
            --sapList_BorderColor: #d9d9d9;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: var(--sapFontFamily);
            font-size: var(--sapFontSize);
            background-color: var(--sapBackgroundColor);
            color: var(--sapTextColor);
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
            margin: 0;
            line-height: 1;
        }

        /* Header superior - SAP Fiori Shell Bar */
        .top-header {
            background-color: var(--sapShellColor);
            color: white;
            padding: 0 1rem;
            height: 44px;
            min-height: 44px;
            display: flex;
            align-items: center;
            gap: 1rem;
            box-shadow: 0 0.125rem 0.5rem 0 rgba(0, 0, 0, 0.3);
            z-index: 1000;
        }

        .menu-toggle {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            padding: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 0.25rem;
            transition: background-color 0.1s ease;
        }

        .menu-toggle:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .menu-toggle:active {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .menu-toggle svg {
            width: 1.25rem;
            height: 1.25rem;
        }

        .header-title {
            font-size: 1rem;
            font-weight: 400;
            margin: 0;
            color: #fff;
        }

        /* Menú desplegable - SAP Fiori Side Navigation */
        .dropdown-menu {
            position: fixed;
            top: 44px;
            left: 0;
            width: 15rem;
            max-height: calc(100vh - 44px);
            background-color: var(--sapShellColor);
            box-shadow: 0 0 0.5rem 0 rgba(0, 0, 0, 0.5);
            transform: translateX(-100%);
            transition: transform 0.2s cubic-bezier(0.1, 0.9, 0.2, 1);
            overflow-y: auto;
            z-index: 999;
        }

        .dropdown-menu.open {
            transform: translateX(0);
        }

        .dropdown-menu nav {
            padding: 0.5rem 0;
        }

        .dropdown-menu a,
        .dropdown-menu .logout-btn {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.625rem 1rem;
            color: #fff;
            text-decoration: none;
            border-radius: 0;
            margin: 0;
            transition: background-color 0.1s ease;
            font-size: 0.875rem;
            border-left: 0.1875rem solid transparent;
        }

        .dropdown-menu a:hover,
        .dropdown-menu .logout-btn:hover {
            background-color: rgba(255, 255, 255, 0.08);
            border-left-color: var(--sapBrandColor);
        }

        .dropdown-menu a:active,
        .dropdown-menu .logout-btn:active {
            background-color: rgba(255, 255, 255, 0.12);
        }

        .dropdown-menu svg {
            width: 1rem;
            height: 1rem;
            flex-shrink: 0;
        }

        .logout-btn {
            background: none;
            border: none;
            width: 100%;
            cursor: pointer;
            text-align: left;
        }

        .menu-overlay {
            position: fixed;
            top: 44px;
            left: 0;
            width: 100%;
            height: calc(100vh - 44px);
            background-color: rgba(0, 0, 0, 0.6);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s ease, visibility 0.2s ease;
            z-index: 998;
        }

        .menu-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .main-content {
            flex-grow: 1;
            overflow-y: auto;
            background-color: var(--sapBackgroundColor);
        }

        /* Botones */
        .btn-primary {
            background-color: var(--sapBrandColor);
            color: white;
            border: 1px solid var(--sapBrandColor);
            padding: 8px 16px;
            border-radius: 3px;
            font-weight: 500;
            font-size: 13px;
            transition: all 0.2s;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-family: var(--sapFontFamily);
        }

        .btn-primary:hover {
            background-color: var(--sapHighlightColor);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
        }

        .btn-secondary {
            background-color: var(--sapNeutralColor);
            color: white;
            border: 1px solid var(--sapNeutralColor);
            padding: 8px 16px;
            border-radius: 3px;
            font-weight: 500;
            font-size: 13px;
            transition: all 0.2s;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-family: var(--sapFontFamily);
        }

        .btn-secondary:hover {
            background-color: #6a7d8f;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
        }

        .btn-success {
            background-color: var(--sapPositiveColor);
            color: white;
            border: 1px solid var(--sapPositiveColor);
            padding: 8px 16px;
            border-radius: 3px;
            font-weight: 500;
            font-size: 13px;
            transition: all 0.2s;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-family: var(--sapFontFamily);
        }

        .btn-success:hover {
            background-color: #2a7d42;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
        }

        /* Estilos para la tabla generada por pandas */
        .dataframe {
            width: 100%;
            border-collapse: collapse;
            background-color: var(--sapTileBackground);
        }

        .dataframe thead {
            background-color: var(--sapShellColor);
            border-bottom: 0.125rem solid var(--sapShellColor);
        }

        .dataframe th {
            padding: 6px 8px;
            text-align: left;
            font-size: 11px;
            font-weight: 600;
            color: white;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            position: relative;
            border-right: 1px solid rgba(255, 255, 255, 0.2);
            font-family: var(--sapFontFamily);
        }

        .dataframe th:last-child {
            border-right: none;
        }

        /* Estilos para las columnas ordenables */
        .sortable {
            cursor: pointer;
            -webkit-user-select: none;
            user-select: none;
            padding-right: 24px !important;
        }

        .sortable::after {
            content: "";
            position: absolute;
            right: 8px;
            top: 50%;
            margin-top: -4px;
            border: 4px solid transparent;
            opacity: 0.3;
            pointer-events: none;
            transition: opacity 0.2s ease-in-out;
        }

        .sortable.asc::after {
            border-bottom-color: var(--sapTextColor);
            opacity: 1;
        }

        .sortable.desc::after {
            content: "";
            border-top-color: var(--sapTextColor);
            opacity: 1;
        }

        .dataframe tbody tr {
            border-bottom: 1px solid var(--sapList_BorderColor);
            transition: background-color 0.1s ease;
        }

        .dataframe tbody tr:nth-child(even) {
            background-color: var(--sapTileBackground);
        }

        .dataframe tbody tr:nth-child(odd) {
            background-color: rgba(0, 0, 0, 0.1);
        }

        .dataframe tbody tr:hover {
            background-color: rgba(10, 110, 209, 0.1);
        }

        .dataframe td {
            padding: 2px 4px;
            font-size: 13px;
            vertical-align: middle;
            border-right: 1px solid var(--sapList_BorderColor);
            color: var(--sapTextColor);
            font-family: var(--sapFontFamily);
        }

        .dataframe td:last-child {
            border-right: none;
        }

        /* SAP Fiori Message Strip Styles */
        #message-container {
            position: fixed;
            top: 44px;
            left: 0;
            right: 0;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 0;
            max-width: 100%;
        }

        .message-strip {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            font-family: var(--sapFontFamily);
            font-size: var(--sapFontSize);
            border-bottom: 0.0625rem solid rgba(0, 0, 0, 0.1);
            animation: slideDown 0.3s ease-out;
            box-shadow: 0 0.125rem 0.5rem 0 rgba(0, 0, 0, 0.15);
        }

        @keyframes slideDown {
            from {
                transform: translateY(-100%);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .message-strip.hiding {
            animation: slideUp 0.3s ease-out forwards;
        }

        @keyframes slideUp {
            from {
                transform: translateY(0);
                opacity: 1;
            }

            to {
                transform: translateY(-100%);
                opacity: 0;
            }
        }

        .message-strip-icon {
            margin-right: 0.75rem;
            flex-shrink: 0;
            width: 1rem;
            height: 1rem;
        }

        .message-strip-text {
            flex-grow: 1;
            line-height: 1.4;
        }

        .message-strip-close {
            background: none;
            border: none;
            cursor: pointer;
            padding: 0.25rem;
            margin-left: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 0.25rem;
            transition: background-color 0.1s ease;
        }

        .message-strip-close:hover {
            background-color: rgba(0, 0, 0, 0.1);
        }

        .message-strip-close svg {
            width: 1rem;
            height: 1rem;
        }

        .message-strip.success {
            background-color: #f1fdf6;
            color: var(--sapPositiveColor);
            border-left: 0.25rem solid var(--sapPositiveColor);
        }

        .message-strip.error {
            background-color: #fef6f6;
            color: var(--sapNegativeColor);
            border-left: 0.25rem solid var(--sapNegativeColor);
        }

        .message-strip.warning {
            background-color: #fef9f0;
            color: var(--sapCriticalColor);
            border-left: 0.25rem solid var(--sapCriticalColor);
        }

        .message-strip.information {
            background-color: #f0f7fe;
            color: var(--sapInformativeColor);
            border-left: 0.25rem solid var(--sapInformativeColor);
        }

        /* Estilos para columnas de ubicación - ancho reducido solo en celdas de datos */
        /* Columnas de ubicación */
        .dataframe td:nth-child(4),
        .dataframe td:nth-child(5) {
            max-width: 80px;
            width: 80px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .dataframe td:nth-child(3) {
            max-width: 350px;
            width: 350px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* Anchos mínimos para encabezados - para que título + icono quepan en una línea */
        .dataframe th:nth-child(1) {
            min-width: 120px;
        }

        .dataframe th:nth-child(2) {
            min-width: 120px;
        }

        .dataframe th:nth-child(3) {
            min-width: 350px;
        }

        .dataframe th:nth-child(4) {
            min-width: 160px;
        }

        .dataframe th:nth-child(5) {
            min-width: 160px;
        }

        .dataframe th:nth-child(6) {
            min-width: 130px;
        }

        .dataframe th:nth-child(7) {
            min-width: 100px;
        }

        .dataframe th:nth-child(8) {
            min-width: 100px;
        }


        /* Contenedor de tabla con scroll */
        .table-container {
            max-height: calc(100vh - 150px);
            overflow: auto;
            position: relative;
        }

        /* Encabezados sticky (inmovilizados) */
        .dataframe thead {
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .dataframe thead tr:first-child th {
            position: sticky;
            top: 0;
            z-index: 11;
        }

        /* Icono de filtro en el encabezado */
        .filter-icon {
            display: inline-block;
            margin-left: 8px;
            cursor: pointer;
            opacity: 0.6;
            transition: opacity 0.2s ease;
            vertical-align: middle;
        }

        .filter-icon:hover {
            opacity: 1;
        }

        .filter-icon.active {
            opacity: 1;
            color: var(--sapBrandColor);
        }

        .filter-icon svg {
            width: 14px;
            height: 14px;
            vertical-align: middle;
        }

        /* Dropdown del filtro */
        .filter-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            min-width: 200px;
            background-color: white;
            border: 1px solid #d9d9d9;
            border-radius: 3px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            padding: 8px;
            z-index: 100;
            display: none;
            margin-top: 4px;
        }

        .filter-dropdown.show {
            display: block;
            animation: fadeIn 0.2s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-8px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Contenedor del filtro con input y borrador */
        .filter-input-container {
            position: relative;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        /* Icono de borrador para limpiar filtro */
        .clear-filter-icon {
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px;
            display: none;
            align-items: center;
            justify-content: center;
            border-radius: 3px;
            transition: all 0.2s ease;
            color: var(--sapNeutralColor);
            flex-shrink: 0;
        }

        .clear-filter-icon:hover {
            background-color: rgba(0, 0, 0, 0.05);
            color: var(--sapNegativeColor);
        }

        .clear-filter-icon svg {
            width: 16px;
            height: 16px;
        }

        /* Input dentro del dropdown */
        .filter-dropdown input {
            flex: 1;
            padding: 8px 32px 8px 12px;
            border: 1px solid #d9d9d9;
            background-color: white;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 16 16' fill='%23666'%3E%3Cpath d='M6 10.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1-.5-.5zm-2-3a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5zm-2-3a.5.5 0 0 1 .5-.5h11a.5.5 0 0 1 0 1h-11a.5.5 0 0 1-.5-.5z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 8px center;
            background-size: 16px 16px;
            color: var(--sapTextColor);
            font-size: 12px;
            border-radius: 3px;
            font-family: var(--sapFontFamily);
            transition: all 0.2s ease;
        }

        .filter-dropdown input::placeholder {
            color: #89919a;
        }

        .filter-dropdown input:focus {
            outline: none;
            border-color: var(--sapBrandColor);
            box-shadow: 0 0 0 1px var(--sapBrandColor);
        }

        .filter-dropdown input:hover {
            border-color: #89919a;
        }

        /* Posición relativa para los th */
        .dataframe th {
            position: relative;
        }

        /* Fila oculta por filtro */
        .dataframe tbody tr.hidden-by-filter {
            display: none;
        }
    </style>
</head>

<body>
    <!-- Header superior con menú -->
    <header class="top-header">
        <button class="menu-toggle" id="menuToggle" aria-label="Abrir menú">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
            </svg>
        </button>
        <h1 class="header-title">Logix - Conciliación</h1>
    </header>

    <!-- Menú desplegable -->
    <nav class="dropdown-menu" id="dropdownMenu">
        <nav>
            <a href="/">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25" />
                </svg>
                <span>Inicio</span>
            </a>
            <a href="/stock">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" />
                </svg>
                <span>Consultar Stock</span>
            </a>
            <a href="/inbound">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M9 8.25H7.5a2.25 2.25 0 00-2.25 2.25v9a2.25 2.25 0 002.25 2.25h9a2.25 2.25 0 002.25-2.25v-9a2.25 2.25 0 00-2.25-2.25H15M9 12l3 3m0 0l3-3m-3 3V2.25" />
                </svg>
                <span>Inbound</span>
            </a>
            <a href="/label">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M9.568 3H5.25A2.25 2.25 0 003 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 005.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 009.568 3z" />
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M12 6.75a.75.75 0 110-1.5.75.75 0 010 1.5z" />
                </svg>
                <span>Etiquetado</span>
            </a>
            <a href="/view_logs">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                    <path
                        d="M5 4a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1zm-.5 2.5A.5.5 0 0 1 5 6h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5M5 8a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1zm0 2a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1z" />
                    <path
                        d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2zm10-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1" />
                </svg>
                <span>Visualizar Logs</span>
            </a>
            <a href="/reconciliation">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                    <path
                        d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z" />
                    <path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0" />
                </svg>
                <span>Ver conciliación</span>
            </a>
            <a href="/update">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                    <path
                        d="M8 11a.5.5 0 0 0 .5-.5V6.707l1.146 1.147a.5.5 0 0 0 .708-.708l-2-2a.5.5 0 0 0-.708 0l-2 2a.5.5 0 1 0 .708.708L7.5 6.707V10.5a.5.5 0 0 0 .5.5" />
                    <path
                        d="M4 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zm0 1h8a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1" />
                </svg>
                <span>Actualizar Ficheros</span>
            </a>
            <a href="/counts">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                    <path
                        d="M14.5 3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5zm-13-1A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2z" />
                    <path
                        d="M7 5.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5m-1.496-.854a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 1 1 .708-.708l.146.147 1.146-1.147a.5.5 0 0 1 .708 0M7 9.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5m-1.496-.854a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 0 1 .708-.708l.146.147 1.146-1.147a.5.5 0 0 1 .708 0" />
                </svg>
                <span>Conteo de Items</span>
            </a>
            <a href="/view_counts">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                    <path
                        d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v4h10V2a1 1 0 0 0-1-1zm9 6h-3v2h3zm0 3h-3v2h3zm0 3h-3v2h2a1 1 0 0 0 1-1zm-4 2v-2H6v2zm-4 0v-2H3v1a1 1 0 0 0 1 1zm-2-3h2v-2H3zm0-3h2V7H3zm3-2v2h3V7zm3 3H6v2h3z" />
                </svg>
                <span>Validar conteos</span>
            </a>
            <a href="/picking">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                    <path
                        d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5M3.102 4l1.313 7h8.17l1.313-7zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4m7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4m-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2m7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2" />
                </svg>
                <span>Auditoría de Picking</span>
            </a>
            <a href="/view_picking_audits">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                    <path fill-rule="evenodd"
                        d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0z" />
                    <path
                        d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z" />
                    <path
                        d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z" />
                </svg>
                <span>Confirmación Picking</span>
            </a>
            <button class="logout-btn" onclick="window.location.href='/logout'">
                <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
                    <path d="M7.5 1v7h1V1z" />
                    <path
                        d="M3 8.812a5 5 0 0 1 2.578-4.375l-.485-.874A6 6 0 1 0 11 3.616l-.501.865A5 5 0 1 1 3 8.812" />
                </svg>
                <span>Cerrar Sesión</span>
            </button>
        </nav>
    </nav>

    <!-- Overlay para cerrar el menú -->
    <div class="menu-overlay" id="menuOverlay"></div>

    <!-- SAP Fiori Message Strip Container -->
    <div id="message-container"></div>

    <!-- Contenido principal -->
    <main class="main-content">
        <div class="container mx-auto p-4 sm:p-6 lg:p-8">
            <div class="flex justify-between items-center mb-6">
                <h1 class="text-2xl sm:text-3xl font-bold"
                    style="color: var(--sapTextColor); font-family: var(--sapFontFamily);">Reporte de
                    Conciliación</h1>

                <div class="flex space-x-2">
                    <button onclick="generateItemsWithoutGrnReport()" class="btn-primary" id="btn-items-without-grn"
                        title="Generar reporte de items sin GRN">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                            viewBox="0 0 16 16">
                            <path d="M8.5 6.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0zm0 2a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0z" />
                            <path
                                d="M14 4.5V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h5.5L14 4.5zm-3 0A1.5 1.5 0 0 0 9.5 3V1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4.5h-2z" />
                        </svg>
                        Items sin GRN
                    </button>
                    <a href="#" onclick="exportReconciliation(event)" class="btn-primary">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                            viewBox="0 0 16 16">
                            <path
                                d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5" />
                            <path
                                d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708z" />
                        </svg>
                        Exportar a Excel
                    </a>
                </div>
            </div>

            {% if error %}
            <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert"
                style="background-color: rgba(229, 41, 41, 0.1); border-color: var(--sapNegativeColor); color: var(--sapNegativeColor);">
                <strong class="font-bold">¡Error!</strong>
                <span class="block sm:inline">Ocurrió un problema al generar el reporte: {{ error }}</span>
            </div>
            {% elif tables %}
            <div class="shadow-md rounded-lg overflow-hidden"
                style="background-color: var(--sapTileBackground); border: 1px solid var(--sapTileBorder);">
                <div class="table-container">
                    {% for table in tables %}
                    {{ table|safe }}
                    {% endfor %}
                </div>
            </div>
            {% else %}
            <div class="text-center py-10 rounded-lg shadow-md" style="background-color: var(--sapTileBackground);">
                <p style="color: var(--sapNeutralColor); font-family: var(--sapFontFamily);">No hay datos disponibles
                    para generar la conciliación.</p>
            </div>
            {% endif %}
        </div>
    </main>

    <script>
        // --- CÓDIGO PARA EL MENÚ DESPLEGABLE ---
        const menuToggle = document.getElementById('menuToggle');
        const dropdownMenu = document.getElementById('dropdownMenu');
        const menuOverlay = document.getElementById('menuOverlay');

        function toggleMenu() {
            dropdownMenu.classList.toggle('open');
            menuOverlay.classList.toggle('active');
        }

        if (menuToggle) {
            menuToggle.addEventListener('click', toggleMenu);
        }

        if (menuOverlay) {
            menuOverlay.addEventListener('click', toggleMenu);
        }

        if (dropdownMenu) {
            const menuLinks = dropdownMenu.querySelectorAll('a, button');
            menuLinks.forEach(link => {
                link.addEventListener('click', () => {
                    if (dropdownMenu.classList.contains('open')) {
                        toggleMenu();
                    }
                });
            });
        }
        // --- FIN DEL CÓDIGO DEL MENÚ ---

        function sortTable(table, column, asc = true) {
            const dirModifier = asc ? 1 : -1;
            const tBody = table.tBodies[0];
            const rows = Array.from(tBody.querySelectorAll("tr"));

            const sortedRows = rows.sort((a, b) => {
                const aColText = a.querySelector(`td:nth-child(${column + 1})`).textContent.trim();
                const bColText = b.querySelector(`td:nth-child(${column + 1})`).textContent.trim();

                const aVal = isNaN(parseFloat(aColText)) ? aColText : parseFloat(aColText);
                const bVal = isNaN(parseFloat(bColText)) ? bColText : parseFloat(bColText);

                return aVal > bVal ? (1 * dirModifier) : (-1 * dirModifier);
            });

            while (tBody.firstChild) {
                tBody.removeChild(tBody.firstChild);
            }

            tBody.append(...sortedRows);

            table.querySelectorAll("th").forEach(th => th.classList.remove("asc", "desc"));
            table.querySelector(`th:nth-child(${column + 1})`).classList.toggle("asc", asc);
            table.querySelector(`th:nth-child(${column + 1})`).classList.toggle("desc", !asc);
        }

        // Almacenar filtros activos
        const activeFilters = {};

        document.addEventListener("DOMContentLoaded", () => {
            const table = document.querySelector(".dataframe");
            if (table) {
                // Añadir iconos de filtro a los encabezados
                const headers = table.querySelectorAll("thead th");
                headers.forEach((header, index) => {
                    // Añadir funcionalidad de ordenamiento
                    const headerText = header.textContent.trim();
                    header.classList.add("sortable");

                    // Crear contenedor para el texto y el icono
                    header.innerHTML = '';
                    const textSpan = document.createElement("span");
                    textSpan.textContent = headerText;
                    header.appendChild(textSpan);

                    // Añadir icono de filtro
                    const filterIcon = document.createElement("span");
                    filterIcon.className = "filter-icon";
                    filterIcon.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M6 10.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1-.5-.5zm-2-3a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5zm-2-3a.5.5 0 0 1 .5-.5h11a.5.5 0 0 1 0 1h-11a.5.5 0 0 1-.5-.5z"/>
                    </svg>`;
                    filterIcon.dataset.columnIndex = index;
                    header.appendChild(filterIcon);

                    // Crear dropdown de filtro
                    const dropdown = document.createElement("div");
                    dropdown.className = "filter-dropdown";

                    // Crear contenedor para input y borrador
                    const inputContainer = document.createElement("div");
                    inputContainer.className = "filter-input-container";

                    const input = document.createElement("input");
                    input.type = "text";
                    input.placeholder = "Filtrar...";
                    input.dataset.columnIndex = index;
                    inputContainer.appendChild(input);

                    // Crear icono de borrador
                    const clearIcon = document.createElement("button");
                    clearIcon.className = "clear-filter-icon";
                    clearIcon.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M8.086 2.207a2 2 0 0 1 2.828 0l3.879 3.879a2 2 0 0 1 0 2.828l-5.5 5.5A2 2 0 0 1 7.879 15H5.12a2 2 0 0 1-1.414-.586l-2.5-2.5a2 2 0 0 1 0-2.828zm2.121.707a1 1 0 0 0-1.414 0L4.16 7.547l5.293 5.293 4.633-4.633a1 1 0 0 0 0-1.414zM8.746 13.547 3.453 8.254 1.914 9.793a1 1 0 0 0 0 1.414l2.5 2.5a1 1 0 0 0 .707.293H7.88a1 1 0 0 0 .707-.293z"/>
                        </svg>
                    `;
                    clearIcon.title = "Limpiar filtro";
                    clearIcon.style.display = "none"; // Oculto por defecto
                    inputContainer.appendChild(clearIcon);

                    dropdown.appendChild(inputContainer);
                    header.appendChild(dropdown);

                    // Evento click en el icono de filtro
                    filterIcon.addEventListener("click", (e) => {
                        e.stopPropagation();
                        // Cerrar otros dropdowns
                        document.querySelectorAll(".filter-dropdown").forEach(d => {
                            if (d !== dropdown) d.classList.remove("show");
                        });
                        document.querySelectorAll(".filter-icon").forEach(i => {
                            if (i !== filterIcon) i.classList.remove("active");
                        });

                        // Toggle este dropdown
                        dropdown.classList.toggle("show");
                        filterIcon.classList.toggle("active");

                        if (dropdown.classList.contains("show")) {
                            input.focus();
                        }
                    });

                    // Evento input para filtrar
                    input.addEventListener("input", function () {
                        activeFilters[index] = this.value;
                        filterTable(table);

                        // Marcar icono como activo si hay filtro
                        if (this.value.trim()) {
                            filterIcon.classList.add("active");
                            clearIcon.style.display = "flex"; // Mostrar icono de borrador
                        } else {
                            filterIcon.classList.remove("active");
                            clearIcon.style.display = "none"; // Ocultar icono de borrador
                            delete activeFilters[index];
                        }
                    });

                    // Evento click en el icono de borrador
                    clearIcon.addEventListener("click", (e) => {
                        e.stopPropagation();
                        input.value = "";
                        delete activeFilters[index];
                        filterIcon.classList.remove("active");
                        clearIcon.style.display = "none";
                        filterTable(table);
                        dropdown.classList.remove("show");
                    });

                    // Prevenir que el click en el dropdown lo cierre
                    dropdown.addEventListener("click", (e) => {
                        e.stopPropagation();
                    });

                    // Evento click en el header para ordenar (solo en el texto)
                    textSpan.addEventListener("click", () => {
                        const currentIsAsc = header.classList.contains("asc");
                        sortTable(table, index, !currentIsAsc);
                    });
                });
            }
        });

        // Cerrar dropdowns al hacer click fuera
        document.addEventListener("click", () => {
            document.querySelectorAll(".filter-dropdown").forEach(d => d.classList.remove("show"));
            document.querySelectorAll(".filter-icon").forEach(i => {
                // Solo remover active si no hay filtro activo
                const input = i.parentElement.querySelector("input");
                if (!input || !input.value.trim()) {
                    i.classList.remove("active");
                }
            });
        });

        // Función para filtrar la tabla
        function filterTable(table) {
            const tbody = table.querySelector("tbody");
            const rows = tbody.querySelectorAll("tr");

            rows.forEach(row => {
                let shouldShow = true;

                // Verificar todos los filtros activos
                for (const [columnIndex, filterValue] of Object.entries(activeFilters)) {
                    const filterVal = filterValue.toLowerCase().trim();
                    if (filterVal) {
                        const cell = row.querySelector(`td:nth-child(${parseInt(columnIndex) + 1})`);
                        if (cell) {
                            const cellText = cell.textContent.toLowerCase().trim();
                            if (!cellText.includes(filterVal)) {
                                shouldShow = false;
                                break;
                            }
                        }
                    }
                }

                if (shouldShow) {
                    row.classList.remove("hidden-by-filter");
                } else {
                    row.classList.add("hidden-by-filter");
                }
            });
        }

        // --- Función para generar reporte de items sin GRN ---
        async function generateItemsWithoutGrnReport() {
            try {
                const btn = document.getElementById('btn-items-without-grn');
                btn.disabled = true;
                btn.innerHTML = '<svg class="animate-spin h-5 w-5 text-white mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Cargando...';

                const response = await fetch('/api/items_without_grn');
                const result = await response.json();

                if (response.ok) {
                    displayItemsWithoutGrnTable(result);
                } else {
                    showNotification(result.detail || 'Error al generar el reporte', 'error');
                }
            } catch (error) {
                console.error('Error:', error);
                showNotification('Error de conexión al generar el reporte', 'error');
            } finally {
                const btn = document.getElementById('btn-items-without-grn');
                btn.disabled = false;
                btn.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M8.5 6.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0zm0 2a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0z"/><path d="M14 4.5V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h5.5L14 4.5zm-3 0A1.5 1.5 0 0 0 9.5 3V1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4.5h-2z"/></svg> Items sin GRN';
            }
        }

        // --- Función para mostrar la tabla de items sin GRN ---
        function displayItemsWithoutGrnTable(result) {
            const container = document.querySelector('.container.mx-auto');

            // Buscar o crear un contenedor para el reporte
            let reportContainer = document.getElementById('items-without-grn-container');
            if (!reportContainer) {
                reportContainer = document.createElement('div');
                reportContainer.id = 'items-without-grn-container';
                reportContainer.style.marginTop = '2rem';
                container.appendChild(reportContainer);
            }

            if (result.data.length === 0) {
                reportContainer.innerHTML = `
                    <div style="background-color: var(--sapTileBackground); border: 1px solid var(--sapTileBorder); padding: 2rem; border-radius: 0.5rem; text-align: center;">
                        <p style="color: var(--sapNeutralColor); font-family: var(--sapFontFamily);">${result.message}</p>
                    </div>
                `;
                showNotification(result.message, 'information');
                return;
            }

            // Crear tabla HTML
            let tableHtml = `
                <div style="background-color: var(--sapTileBackground); border: 1px solid var(--sapTileBorder); border-radius: 0.5rem; overflow: hidden;">
                    <div style="padding: 0.75rem 1rem; border-bottom: 1px solid var(--sapTileBorder); display: flex; justify-content: space-between; align-items: center; background-color: #e8e8e8;">
                        <h3 style="margin: 0; font-family: var(--sapFontFamily); font-size: 0.875rem; font-weight: 600; color: var(--sapTextColor);">
                            ${result.message} (${result.data.length})
                        </h3>
                        <button onclick="exportItemsWithoutGrn()" class="btn-primary" style="padding: 0.5rem 1rem; font-size: 0.875rem;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 16 16" style="display: inline; margin-right: 0.5rem;">
                                <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5" />
                                <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708z" />
                            </svg>
                            Exportar
                        </button>
                    </div>
                    <div class="table-container">
                        <table class="min-w-full leading-normal dataframe" border="0" cellpadding="0" cellspacing="0" style="table-layout: fixed;">
                            <thead>
                                <tr style="background-color: #e8e8e8;">
                                    ${result.columns.map(col => `<th style="padding: 0.75rem; text-align: left; font-weight: bold; border-bottom: 1px solid var(--sapList_BorderColor); color: var(--sapTextColor); font-family: var(--sapFontFamily); font-size: var(--sapFontSize); width: ${100 / result.columns.length}%;">${col}</th>`).join('')}
                                </tr>
                            </thead>
                            <tbody>
                                ${result.data.map(row => `
                                    <tr style="border-bottom: 1px solid var(--sapList_BorderColor);">
                                        ${result.columns.map(col => `<td style="padding: 0rem; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="${row[col] || ''}">${row[col] || ''}</td>`).join('')}
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;

            reportContainer.innerHTML = tableHtml;
            showNotification(result.message, 'success');
        }

        // --- Función para exportar items sin GRN a Excel ---
        async function exportItemsWithoutGrn() {
            try {
                const timezoneOffset = new Date().getTimezoneOffset();
                const link = document.createElement('a');
                link.href = `/api/export_items_without_grn?timezone_offset=${timezoneOffset}`;
                link.download = true;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                showNotification('Descargando reporte...', 'success');
            } catch (error) {
                console.error('Error:', error);
                showNotification('Error al descargar el reporte', 'error');
            }
        }

        // --- Función para exportar conciliación general ---
        function exportReconciliation(event) {
            event.preventDefault();
            const timezoneOffset = new Date().getTimezoneOffset();
            window.location.href = `/api/export_reconciliation?timezone_offset=${timezoneOffset}`;
            showNotification('Descargando reporte de conciliación...', 'information');
        }

        // --- Función para mostrar notificaciones SAP Fiori ---
        function showNotification(message, type = 'information') {
            const messageContainer = document.getElementById('message-container');
            if (!messageContainer) return;

            const messageStrip = document.createElement('div');
            messageStrip.style.cssText = `
                padding: 0.75rem 1rem;
                margin-bottom: 1rem;
                border-radius: 0.25rem;
                display: flex;
                align-items: center;
                border: 1px solid;
            `;

            const icons = {
                success: { bg: 'rgba(16, 126, 62, 0.1)', border: '#107e3e', color: '#107e3e', icon: '<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>' },
                error: { bg: 'rgba(176, 0, 0, 0.1)', border: '#b00', color: '#b00', icon: '<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path>' },
                information: { bg: 'rgba(10, 110, 209, 0.1)', border: '#0a6ed1', color: '#0a6ed1', icon: '<path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>' }
            };

            const style = icons[type] || icons.information;

            messageStrip.style.backgroundColor = style.bg;
            messageStrip.style.borderColor = style.border;
            messageStrip.style.color = style.color;

            messageStrip.innerHTML = `
                <svg fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" style="width: 1.25rem; height: 1.25rem; margin-right: 0.75rem; flex-shrink: 0;">
                    ${style.icon}
                </svg>
                <span>${message}</span>
                <button onclick="this.parentElement.remove()" style="background: none; border: none; cursor: pointer; margin-left: auto; padding: 0;">
                    <svg fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" style="width: 1.25rem; height: 1.25rem;">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            `;

            messageContainer.appendChild(messageStrip);

            setTimeout(() => {
                if (messageStrip.parentElement) {
                    messageStrip.style.opacity = '0';
                    messageStrip.style.transition = 'opacity 0.3s ease';
                    setTimeout(() => messageStrip.remove(), 300);
                }
            }, 6000);
        }
    </script>

</body>

</html>