const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/qrcode-vendor-cb-SQVWm.js","assets/react-vendor-BFe66WFD.js"])))=>i.map(i=>d[i]);
import{_ as e,j as t}from"./index-Ct3ZkX5-.js";import{r}from"./react-vendor-BFe66WFD.js";import{y as n}from"./ui-vendor-i8Pm06Jj.js";const c=({onClose:c,onScan:a,title:i="Apunta la cámara al código de barras"})=>{const o="global-reader",s=r.useRef(null),[l,d]=r.useState(!1);r.useEffect(()=>(e(async()=>{const{Html5Qrcode:e}=await import("./qrcode-vendor-cb-SQVWm.js").then(e=>e.i);return{Html5Qrcode:e}},__vite__mapDeps([0,1])).then(({Html5Qrcode:e})=>{if(s.current)try{s.current.clear()}catch(r){}const t=new e(o);s.current=t,t.start({facingMode:"environment"},{fps:10,qrbox:{width:250,height:250}},async e=>{const n=e.toUpperCase();(()=>{try{const e=window.AudioContext||window.webkitAudioContext;if(!e)return;const t=new e,r=t.createOscillator(),n=t.createGain();r.type="sine",r.frequency.setValueAtTime(800,t.currentTime),r.frequency.exponentialRampToValueAtTime(400,t.currentTime+.1),n.gain.setValueAtTime(.5,t.currentTime),n.gain.exponentialRampToValueAtTime(.01,t.currentTime+.1),r.connect(n),n.connect(t.destination),r.start(),r.stop(t.currentTime+.15)}catch(e){}})();try{await t.stop(),t.clear()}catch(r){}s.current=null,a(n)},e=>{}).catch(e=>{n.error("Error al iniciar cámara: "+e),c()})}),()=>{if(s.current)try{s.current.stop().catch(()=>{});try{s.current.clear()}catch(e){}}catch(e){}}),[]);return t.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg relative",children:[t.jsx("h3",{className:"text-center font-bold text-lg mb-4 text-gray-800",children:i}),t.jsx("div",{id:o,className:"rounded-lg overflow-hidden mb-4 border-2 border-gray-100"}),t.jsxs("div",{className:"flex gap-3",children:[t.jsxs("button",{type:"button",onClick:()=>{s.current&&s.current.applyVideoConstraints({advanced:[{torch:!l}]}).then(()=>d(!l)).catch(e=>{n.error("Flash no disponible")})},className:"flex-1 h-12 flex items-center justify-center gap-2 rounded bg-[#34495e] hover:bg-[#2c3e50] text-white font-medium transition-colors "+(l?"ring-2 ring-yellow-400":""),title:l?"Apagar Flash":"Encender Flash",children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",viewBox:"0 0 16 16",children:t.jsx("path",{d:"M2 6a6 6 0 1 1 10.174 4.31c-.203.196-.359.4-.453.619l-.762 1.769A.5.5 0 0 1 10.5 13a.5.5 0 0 1 0 1 .5.5 0 0 1 0 1l-.224.447a1 1 0 0 1-.894.553H6.618a1 1 0 0 1-.894-.553L5.5 15a.5.5 0 0 1 0-1 .5.5 0 0 1 0-1 .5.5 0 0 1-.46-.302l-.761-1.77a1.964 1.964 0 0 0-.453-.618A5.984 5.984 0 0 1 2 6zm6-5a5 5 0 0 0-3.479 8.592c.263.254.514.564.676.941L5.83 12h4.342l.632-1.467c.162-.377.413-.687.676-.941A5 5 0 0 0 8 1z"})}),"Flash"]}),t.jsx("button",{type:"button",onClick:()=>{s.current?s.current.stop().then(()=>{try{s.current.clear()}catch(e){}s.current=null,c()}).catch(e=>{c()}):c()},className:"flex-1 h-12 flex items-center justify-center bg-[#d32f2f] hover:bg-[#b71c1c] text-white font-medium rounded transition-colors",children:"Cancelar"})]})]})})};export{c as S};
