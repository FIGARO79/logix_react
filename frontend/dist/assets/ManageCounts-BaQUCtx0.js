import{j as e}from"./index-BYgTg5Ia.js";import{h as t,e as s,r}from"./react-vendor-BFe66WFD.js";const a=()=>{const a=t(),{setTitle:o}=s(),[n,i]=r.useState([]),[d,l]=r.useState(!0),[c,x]=r.useState(null),[m,h]=r.useState(""),[b,p]=r.useState(""),[u,j]=r.useState("");r.useEffect(()=>{o("Gestionar Conteos")},[o]);const f=async()=>{l(!0);try{const e=await fetch("/api/counts/all");if(!e.ok)throw new Error("Error loading counts");const t=await e.json();i(t)}catch(e){x(e.message)}finally{l(!1)}};r.useEffect(()=>{f()},[]);return e.jsxs("div",{className:"max-w-[1920px] mx-auto px-4 py-6 font-sans text-sm text-[#32363a]",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-xl font-normal text-[#32363a] mb-1",children:"Gestionar Conteos Individuales"}),e.jsx("p",{className:"text-sm text-[#6a6d70]",children:"Visualiza y administra todos los registros de conteo del sistema"})]}),e.jsx("div",{className:"mb-6 max-w-lg",children:e.jsxs("div",{className:"bg-[#fff3cd] border-l-4 border-[#e9730c] rounded p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center mb-3 text-[#e9730c]",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),e.jsx("h2",{className:"text-base font-semibold text-[#32363a]",children:"Reabrir Ubicación"})]}),u&&e.jsx("div",{className:"text-green-600 text-xs font-bold mb-2",children:u}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{const e=await fetch("/api/locations/reopen",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:parseInt(m),location_code:b})});if(!e.ok){const t=await e.json();throw new Error(t.detail||"Error")}j(`Ubicación ${b} reabierta.`),h(""),p(""),setTimeout(()=>j(""),5e3)}catch(t){alert(t.message)}},className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-[#32363a] mb-0.5",children:"ID Sesión:"}),e.jsx("input",{type:"number",value:m,onChange:e=>h(e.target.value),className:"block w-full border border-[#89919a] rounded p-1 h-9",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-[#32363a] mb-0.5",children:"Cód. Ubicación:"}),e.jsx("input",{type:"text",value:b,onChange:e=>p(e.target.value.toUpperCase()),className:"block w-full border border-[#89919a] rounded p-1 h-9",required:!0})]}),e.jsx("button",{type:"submit",className:"w-full bg-[#e9730c] hover:bg-[#d1670b] text-white font-medium py-2 rounded text-sm transition-colors h-9",children:"Reabrir"})]})]})}),e.jsx("div",{className:"flex justify-end items-center mb-6",children:e.jsxs("button",{onClick:()=>a("/view_counts"),className:"inline-flex items-center px-4 py-2 border border-[#0854a0] text-[#0a6ed1] bg-white text-sm font-medium rounded hover:bg-[#ebf5fe] transition-colors",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16l-4-4m0 0l4-4m-4 4h18"})}),"Volver a vista agrupada (Validar)"]})}),e.jsxs("div",{className:"bg-white shadow-sm rounded border border-[#d9d9d9] overflow-hidden",children:[e.jsxs("div",{className:"bg-[#f2f2f2] px-4 py-3 border-b border-[#e5e5e5] flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2 text-[#32363a]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),e.jsx("h2",{className:"text-sm font-semibold text-[#32363a]",children:"Tabla de Conteos"})]}),e.jsxs("span",{className:"text-xs px-2 py-1 rounded bg-[#f2f2f2] text-[#6a6d70]",children:[n.length," registros"]})]}),e.jsx("div",{className:"overflow-x-auto max-h-[70vh]",children:e.jsxs("table",{className:"min-w-full text-left border-collapse",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsx("tr",{children:["ID Conteo","ID Sesión","Usuario","Timestamp","Item Code","Descripción","Ubic. Contada","Cant. Contada","Acción"].map((t,s)=>e.jsx("th",{className:"px-4 py-2 border-b border-[#e5e5e5] text-xs font-semibold uppercase tracking-wider whitespace-nowrap",children:t},s))})}),"                        ",e.jsx("tbody",{className:"divide-y divide-[#e5e5e5]",children:d?e.jsx("tr",{children:e.jsx("td",{colSpan:"9",className:"p-8 text-center text-gray-500",children:"Cargando..."})}):0===n.length?e.jsx("tr",{children:e.jsx("td",{colSpan:"9",className:"p-12 text-center text-gray-500",children:e.jsx("p",{className:"font-medium",children:"No hay registros"})})}):n.map(t=>e.jsxs("tr",{className:"hover:bg-[#f5f5f5] transition-colors",children:[e.jsx("td",{className:"px-4 py-2 border-b border-[#e5e5e5] text-sm font-semibold",children:t.id}),e.jsx("td",{className:"px-4 py-2 border-b border-[#e5e5e5] text-sm",children:t.session_id}),e.jsx("td",{className:"px-4 py-2 border-b border-[#e5e5e5] text-sm font-medium",children:t.username||"-"}),e.jsx("td",{className:"px-4 py-2 border-b border-[#e5e5e5] text-xs text-gray-600 whitespace-nowrap",children:t.timestamp}),e.jsx("td",{className:"px-4 py-2 border-b border-[#e5e5e5] text-sm font-bold",children:t.item_code}),e.jsx("td",{className:"px-4 py-2 border-b border-[#e5e5e5] text-sm text-gray-600 truncate max-w-[200px]",title:t.item_description,children:t.item_description}),e.jsx("td",{className:"px-4 py-2 border-b border-[#e5e5e5] text-sm",children:t.counted_location}),e.jsx("td",{className:"px-4 py-2 border-b border-[#e5e5e5] text-sm",children:t.counted_qty}),e.jsxs("td",{className:"px-4 py-2 border-b border-[#e5e5e5] text-center flex gap-1 justify-center",children:[e.jsx("button",{onClick:()=>a(`/counts/edit/${t.id}`),title:"Editar",className:"text-indigo-600 hover:bg-indigo-50 p-1 rounded",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:()=>(async e=>{if(window.confirm("¿Eliminar este conteo permanentemente?"))try{if(!(await fetch(`/api/counts/${e}`,{method:"DELETE"})).ok)throw new Error("Error deleting");f()}catch(t){alert(t.message)}})(t.id),title:"Eliminar",className:"text-red-600 hover:bg-red-50 p-1 rounded",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},t.id))})]})})]})]})};export{a as default};
