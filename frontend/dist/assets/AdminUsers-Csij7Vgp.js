import{j as e}from"./index-BYgTg5Ia.js";import{h as r,r as s}from"./react-vendor-BFe66WFD.js";import{A as t}from"./AdminLayout-Boht-nAx.js";const a=()=>{const a=r(),[o,n]=s.useState([]),[i,d]=s.useState(null),[l,c]=s.useState(null),x=async()=>{try{const e=await fetch("/api/admin/users");if(401===e.status)return void a("/admin/login");if(!e.ok)throw new Error("Error loading users");const r=await e.json();n(r)}catch(e){c(e.message)}};s.useEffect(()=>{x()},[]);return e.jsxs(t,{title:"Gestión de Usuarios",children:[i&&e.jsxs("div",{className:"mb-6 p-4 border-l-4 border-green-600 bg-green-50 text-green-800 rounded-r shadow-sm flex items-center gap-3",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),i]}),l&&e.jsxs("div",{className:"mb-6 p-4 border-l-4 border-red-600 bg-red-50 text-red-800 rounded-r shadow-sm flex items-center gap-3",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),l]}),e.jsxs("div",{className:"bg-white rounded shadow-sm border border-transparent hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 bg-gray-50 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-normal text-gray-800",children:"Usuarios Registrados"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[o.length," Usuarios"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"uppercase font-normal text-xs border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-center w-16",children:"ID"}),e.jsx("th",{className:"px-6 py-3 font-normal",children:"Usuario"}),e.jsx("th",{className:"px-6 py-3 text-center font-normal",children:"Estado"}),e.jsx("th",{className:"px-6 py-3 text-center font-normal",children:"Acciones"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-200",children:[o.map(r=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 text-center text-gray-500",children:r.id}),e.jsx("td",{className:"px-6 py-4 font-medium text-gray-900",children:r.username}),e.jsx("td",{className:"px-6 py-4 text-center",children:r.is_approved?e.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-700 border border-green-200/50",children:"Aprobado"}):e.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-semibold bg-orange-100 text-orange-700 border border-orange-200/50",children:"Pendiente"})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsxs("div",{className:"flex justify-center items-center gap-2",children:[e.jsx("button",{className:"px-3 py-1 border border-blue-500 text-blue-600 rounded text-xs hover:bg-blue-50 transition-colors",onClick:()=>{alert("Verificar contraseña (no implementado en React aún)")},children:"Verificar"}),!r.is_approved&&e.jsx("button",{onClick:()=>(async e=>{if(window.confirm("¿Aprobar este usuario?"))try{if(!(await fetch(`/api/admin/approve/${e}`,{method:"POST"})).ok)throw new Error("Failed to approve");d(`Usuario ${e} aprobado`),x()}catch(r){c(r.message)}})(r.id),className:"px-3 py-1 bg-blue-600 text-white rounded text-xs hover:bg-blue-700 transition-colors border border-blue-600",children:"Aprobar"}),e.jsx("button",{onClick:()=>(async e=>{const r=prompt("Ingrese nueva contraseña:");if(r)try{const s=new FormData;if(s.append("new_password",r),!(await fetch(`/api/admin/reset_password/${e}`,{method:"POST",body:s})).ok)throw new Error("Failed to reset password");d(`Contraseña restablecida para usuario ${e}`)}catch(s){c(s.message)}})(r.id),className:"px-3 py-1 border border-blue-500 text-blue-600 rounded text-xs hover:bg-blue-50 transition-colors",children:"Reset Pass"}),e.jsx("button",{onClick:()=>(async e=>{if(window.confirm("¿ELIMINAR este usuario permanentemente?"))try{if(!(await fetch(`/api/admin/delete/${e}`,{method:"POST"})).ok)throw new Error("Failed to delete");d(`Usuario ${e} eliminado`),x()}catch(r){c(r.message)}})(r.id),className:"p-1 text-red-600 hover:bg-red-50 rounded border border-red-200 ml-1",title:"Eliminar",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},r.id)),0===o.length&&e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center py-8 text-gray-400 italic",children:"No hay usuarios registrados."})})]})]})})]}),e.jsx("div",{className:"mt-8 text-center",children:e.jsxs("button",{onClick:()=>a("/"),className:"text-sm text-gray-500 hover:text-gray-800 flex items-center justify-center gap-2 mx-auto",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Volver a la aplicación principal"]})})]})};export{a as default};
